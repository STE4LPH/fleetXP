import base64

script =" aW1wb3J0IHN5cyx0aW1lLG9zLHB5ZmlnbGV0CgojUm9qbwpSID0gJ1wwMzNbMTszMW0nCkdSID0gJ1wwOzM3WzE7MzcnCiNWZXJkZQpWID0gJ1wwMzNbMTszMm0nCkdLPSdcMDMzWzkybScKCiNPc2N1cm8gVmVyZGUKUyA9ICdcMDMzWzkybScKCiNBbWFyaWxsbwpBID0gJ1wwMzNbMTszM20nCgojQXp1bApaID0gJ1wwMzNbMDszNG0nCgojTW9yYWRvCk0gPSAnXDAzM1sxOzM1bScKCiNDZWxlc3RlCkMgPSAnXDAzM1sxOzM2bScKCiNCbGFuY28KQiA9ICdcMDMzWzM3O20nCgojTmVncm8KRyA9ICdcMDMzWzA7MzAnCgojUmVpbmljaWFyCkUgPSAnXDAzM1swbScKbXVybyA9IE0rIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0iK0UKcHJpbnQgKG11cm8pCnByaW50IChWKQpiYW5uZXIgPSBweWZpZ2xldC5maWdsZXRfZm9ybWF0KCJGbGVldCBYUCIpIApwcmludChiYW5uZXIrRSkgCnByaW50IChBKyJDcmVhZG9yIDoiLCBSKyIgUElSQVRFIEZPVU5ERVIiLEMrIihUb3AgOCkiK0UpCnByaW50IChtdXJvKQpkZWYgbnVtYmVycG9zdCh2YWxvcik6CiAgICB0cnk6CiAgICAgICAgdmFsb3IgPSBpbnQodmFsb3IpCiAgICAgICAgaWYgdmFsb3IgPiAwOgogICAgICAgICAgICByZXR1cm4gdmFsb3IKICAgICAgICBtaCA9IFIrIk5vIHNlIHBlcm1pdGVuIG7Dum1lcm9zIG5lZ2F0aXZvcyBwdXRvICIrRQogICAgICAgIGZvciBrIGluIG1oOgogICAgICAgIAlzeXMuc3Rkb3V0LmZsdXNoKCkKICAgICAgICAJcHJpbnQgKGssZW5kPSIiKQogICAgICAgIAl0aW1lLnNsZWVwKDAuMSkKICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBleGNlcHQ6CiAgICAgICAgbWsgPSBSKyJcblBvcnF1ZSBtaWVyZGEgcG9uZXMge0xFVFJBU30gZmVvIGRlIG1pZXJkYSBcbiIrRQogICAgICAgIGZvciBrIGluIG1rOgogICAgICAgIAlzeXMuc3Rkb3V0LmZsdXNoKCkKICAgICAgICAJcHJpbnQgKGssZW5kPSIiKQogICAgICAgIAl0aW1lLnNsZWVwKDAuMSkKICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgcmV0dXJuIEZhbHNlCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpkZWYga3JhbShwcmVndW50YSk6CiAgICByZXNwdWVzdGEgPSBGYWxzZQogICAgd2hpbGUgcmVzcHVlc3RhIGlzIEZhbHNlOgogICAgICAgIHJlc3B1ZXN0YSA9IG51bWJlcnBvc3QoaW5wdXQocHJlZ3VudGEpKQogICAgcmV0dXJuIGludChyZXNwdWVzdGEpCgpqdWdhZG9yID0gIlBsYXllciIKbmFtZSA9IGlucHV0KGYiXG5Ob21icmUgZGVsIFt7QStqdWdhZG9yK0V9XSA9PiAiK0UpCnByaW50ICgiXG4iK211cm8pCm5hbWUgPSBuYW1lLnRpdGxlKCkKbGV2ZWwgPSBrcmFtKGYiXG5OaXZlbCBkZSBbe0MrbmFtZStFfV0gPT4gIikKcHJpbnQgKCJcbiIrbXVybykKbGV2ZWxfb25lID0gaW50KGxldmVsKSAtIDEKYW5sZWNlbCA9ICBzdHIobGV2ZWxfb25lKSArICI5IgpyZXN1bHQgPSBpbnQoYW5sZWNlbCkgKiBsZXZlbF9vbmUgLSA5MDAwMApjb2RpbmcgPSAgKGZvcm1hdChyZXN1bHQsICcsZCcpKQpmb3IgaSBpbiBjb2Rpbmc6CglpZiBpID09ICIsIjoKCQlyID0gQSsiLCIrRQoJCXdoeCA9IGNvZGluZy5yZXBsYWNlKCIsIixyKQpnbyA9ICJYUCIKcHJpbnQgKGYiXG5FbCBqdWdhZG9yIHtDK25hbWUrRX0gdGllbmUge1YrZ28rRX06IHt3aHh9XG4iKQpwcmludCAobXVybykK"

exec(base64.b64decode(script))
